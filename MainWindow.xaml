<Window x:Class="MinsPDFViewer.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:MinsPDFViewer"
        mc:Ignorable="d"
        Title="MinsPDFViewer"
        x:Name="RootWindow"
        AllowDrop="True"
        Drop="Window_Drop"
        PreviewDragOver="Window_DragOver"
        Height="800"
        Width="1200"
        UseLayoutRounding="True"
        Icon="MinsPDFViewer.ico"
        PreviewKeyDown="Window_PreviewKeyDown"
        PreviewMouseDown="Window_PreviewMouseDown"
        PreviewMouseMove="Window_PreviewMouseMove"
        PreviewMouseUp="Window_PreviewMouseUp"
        PreviewMouseWheel="Window_PreviewMouseWheel"
        Closing="Window_Closing">

        <Window.Resources>
                <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
                <local:BoolToFontWeightConverter x:Key="BoolToFontWeightConverter"/>

                <DataTemplate x:Key="SignaturePlaceholderTemplate">
                        <Grid Width="{Binding Width}"
                                        Height="{Binding Height}"
                                        Cursor="SizeAll"
                                        PreviewMouseDown="AnnotationDragHandle_PreviewMouseDown">
                                <Rectangle Stroke="Red"
                                                StrokeThickness="2"
                                                StrokeDashArray="4 2"
                                                Fill="#10FF0000"/>
                                <TextBlock Text="더블 클릭하여&#x0a;서명 수행"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                TextAlignment="Center"
                                                Foreground="Red"
                                                FontWeight="Bold"/>
                                <Image Source="{Binding VisualStampPath}"
                                                Stretch="Fill"
                                                Opacity="0.9"/>
                                <Rectangle Stroke="Blue"
                                                StrokeThickness="1"
                                                StrokeDashArray="2 2"
                                                Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                <Thumb HorizontalAlignment="Right"
                                                VerticalAlignment="Bottom"
                                                Width="10"
                                                Height="10"
                                                Cursor="SizeNWSE"
                                                DragDelta="ResizeThumb_DragDelta"
                                                Background="Red"
                                                Opacity="0.5"/>
                        </Grid>
                </DataTemplate>

                <DataTemplate x:Key="FreeTextTemplate">
                        <Grid Width="{Binding Width}"
                                        Height="{Binding Height}">
                                <Grid.RowDefinitions>
                                        <RowDefinition Height="20"/>
                                        <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <Border Grid.Row="0"
                                                BorderBrush="Gray"
                                                BorderThickness="1,1,1,0"
                                                CornerRadius="3,3,0,0"
                                                Cursor="SizeAll"
                                                Background="Transparent"
                                                PreviewMouseDown="AnnotationDragHandle_PreviewMouseDown">
                                        <Border.Style>
                                                <Style TargetType="Border">
                                                        <Setter Property="Background"
                                                                        Value="Transparent"/>
                                                        <Setter Property="Visibility"
                                                                        Value="Collapsed"/>
                                                        <Style.Triggers>
                                                                <DataTrigger Binding="{Binding IsSelected}"
                                                                                Value="True">
                                                                        <Setter Property="Background"
                                                                                        Value="#DDDDDD"/>
                                                                        <Setter Property="Visibility"
                                                                                        Value="Visible"/>
                                                                </DataTrigger>
                                                        </Style.Triggers>
                                                </Style>
                                        </Border.Style>
                                        <TextBlock Text="::"
                                                        HorizontalAlignment="Center"
                                                        VerticalAlignment="Center"
                                                        Foreground="Gray"
                                                        FontWeight="Bold"
                                                        FontSize="10"/>
                                </Border>

                                <Border Grid.Row="1"
                                                BorderBrush="Gray"
                                                BorderThickness="1"
                                                Background="#EEFFFFFF">
                                        <TextBox Text="{Binding TextContent, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                 FontFamily="{Binding FontFamily}"
                                                 FontSize="{Binding FontSize}"
                                                 FontWeight="{Binding IsBold, Converter={StaticResource BoolToFontWeightConverter}}"
                                                 Foreground="{Binding Foreground}"
                                                 Background="Transparent"
                                                 BorderThickness="0"
                                                 FocusVisualStyle="{x:Null}"
                                                 AcceptsReturn="True"
                                                 TextWrapping="Wrap"
                                                 Padding="5"
                                                 Loaded="AnnotationTextBox_Loaded"
                                                 GotFocus="AnnotationTextBox_GotFocus"
                                                 LostFocus="AnnotationTextBox_LostFocus"
                                                 PreviewKeyDown="AnnotationTextBox_PreviewKeyDown"
                                                 TextChanged="AnnotationTextBox_TextChanged"/>
                                </Border>

                                <Thumb Grid.Row="1"
                                                HorizontalAlignment="Right"
                                                VerticalAlignment="Bottom"
                                                Width="10"
                                                Height="10"
                                                Cursor="SizeNWSE"
                                                DragDelta="ResizeThumb_DragDelta"
                                                Background="Gray"
                                                Opacity="0.5"
                                                Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                        </Grid>
                </DataTemplate>

                <DataTemplate x:Key="HighlightTemplate">
                        <Border Width="{Binding Width}"
                                        Height="{Binding Height}"
                                        Background="{Binding Background}"
                                        Cursor="Hand"
                                        PreviewMouseDown="Annotation_PreviewMouseDown"/>
                </DataTemplate>

                <DataTemplate x:Key="UnderlineTemplate">
                        <Border Width="{Binding Width}"
                                        Height="{Binding Height}"
                                        Background="{Binding Background}"
                                        Cursor="Hand"
                                        PreviewMouseDown="Annotation_PreviewMouseDown"/>
                </DataTemplate>

                <DataTemplate x:Key="SearchHighlightTemplate">
                        <Border Width="{Binding Width}"
                                        Height="{Binding Height}"
                                        Background="{Binding Background}"/>
                </DataTemplate>

                <DataTemplate x:Key="SignatureFieldTemplate">
                        <Button Width="{Binding Width}"
                                        Height="{Binding Height}"
                                        Background="Transparent"
                                        BorderBrush="Transparent"
                                        BorderThickness="0"
                                        Cursor="Hand"
                                        ToolTip="클릭하여 서명 검증"
                                        Click="BtnVerifySignature_Click">
                                <Button.Template>
                                        <ControlTemplate TargetType="Button">
                                                <Border Background="Transparent"
                                                                BorderBrush="Transparent"
                                                                BorderThickness="0"/>
                                        </ControlTemplate>
                                </Button.Template>
                        </Button>
                </DataTemplate>
        </Window.Resources>

        <Grid>
                <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <ToolBarTray Grid.Row="0"
                                Background="White">
                        <ToolBar>
                                <Button Name="BtnOpen"
                                                Content="📂 열기"
                                                Click="BtnOpen_Click"
                                                Margin="0,0,5,0"/>
                                <Button Name="BtnSave"
                                                Content="💾 저장"
                                                Click="BtnSave_Click"
                                                Margin="0,0,5,0"/>
                                <Button Name="BtnSaveAs"
                                                Content="💾 다른 이름으로"
                                                Click="BtnSaveAs_Click"
                                                Margin="0,0,10,0"/>
                                <Separator/>
                                <Button Content="🔖 책갈피"
                                                Click="BtnToggleSidebar_Click"
                                                Margin="0,0,5,0"/>
                                <Separator/>
                                <RadioButton Name="RbCursor"
                                                GroupName="Tools"
                                                Content="👆 선택"
                                                IsChecked="True"
                                                Checked="Tool_Checked"
                                                Margin="5,0"/>
                                <RadioButton Name="RbHighlight"
                                                GroupName="Tools"
                                                Content="🖍 형광펜"
                                                Checked="Tool_Checked"
                                                Margin="5,0"/>
                                <RadioButton Name="RbText"
                                                GroupName="Tools"
                                                Content="📝 텍스트"
                                                Checked="Tool_Checked"
                                                Margin="5,0"/>
                                <Separator/>
                                <Button Name="BtnZoomOut"
                                                Content="➖"
                                                Click="BtnZoomOut_Click"/>
                                <Button Name="BtnZoomIn"
                                                Content="➕"
                                                Click="BtnZoomIn_Click"/>
                                <Button Name="BtnFitWidth"
                                                Content="↔ 폭 맞춤"
                                                Click="BtnFitWidth_Click"/>
                                <Button Name="BtnFitHeight"
                                                Content="↕ 높이 맞춤"
                                                Click="BtnFitHeight_Click"/>
                                <Separator/>
                                <Button Content="📄+"
                                                ToolTip="빈 페이지 추가"
                                                Click="BtnAddBlankPage_Click"/>
                                <Button Content="🗑️"
                                                ToolTip="페이지 삭제"
                                                Click="BtnDeletePage_Click"/>
                                <Button Content="↺"
                                                ToolTip="왼쪽 회전"
                                                Click="BtnRotateLeft_Click"/>
                                <Button Content="↻"
                                                ToolTip="오른쪽 회전"
                                                Click="BtnRotateRight_Click"/>
                                <Separator/>

                                <Button Name="BtnOCR"
                                                Content="👁 OCR 분석"
                                                Click="BtnOCR_Click"
                                                FontWeight="Bold"
                                                Foreground="Blue"/>
                                <Separator/>
                                <Button Name="BtnSign"
                                                Content="🔐 전자서명"
                                                Click="BtnSign_Click"
                                                FontWeight="Bold"
                                                Margin="0,0,5,0"/>
                                <Separator/>
                        </ToolBar>

                        <ToolBar Name="TextStyleToolbar"
                                        Visibility="Collapsed">
                                <ComboBox Name="CbFont"
                                                Width="100"
                                                SelectionChanged="StyleChanged"/>
                                <ComboBox Name="CbSize"
                                                Width="50"
                                                SelectionChanged="StyleChanged"/>
                                <ToggleButton Name="BtnBold"
                                                Content="𝐁"
                                                FontWeight="Bold"
                                                Click="StyleChanged"/>
                                <ComboBox Name="CbColor"
                                                Width="80"
                                                SelectionChanged="StyleChanged">
                                        <ComboBoxItem Content="검정"
                                                        Tag="Black"
                                                        IsSelected="True"/>
                                        <ComboBoxItem Content="빨강"
                                                        Tag="Red"
                                                        Foreground="Red"/>
                                        <ComboBoxItem Content="파랑"
                                                        Tag="Blue"
                                                        Foreground="Blue"/>
                                        <ComboBoxItem Content="초록"
                                                        Tag="Green"
                                                        Foreground="Green"/>
                                        <ComboBoxItem Content="주황"
                                                        Tag="Orange"
                                                        Foreground="Orange"/>
                                </ComboBox>
                                <Button Name="BtnDeleteAnnotation"
                                                Content="🗑 삭제"
                                                Click="BtnDeleteAnnotation_Click"/>
                        </ToolBar>

                        <ToolBar>
                                <TextBox Name="TxtSearch"
                                                Width="150"
                                                PreviewKeyDown="TxtSearch_PreviewKeyDown"
                                                ToolTip="Enter: 다음, Ctrl+Enter: 이전"/>
                                <Button Name="BtnSearch"
                                                Content="🔍"
                                                Click="BtnSearch_Click"/>
                                <Button Name="BtnPrevSearch"
                                                Content="◀"
                                                Click="BtnPrevSearch_Click"/>
                                <Button Name="BtnNextSearch"
                                                Content="▶"
                                                Click="BtnNextSearch_Click"/>
                        </ToolBar>
                </ToolBarTray>

                <Grid Grid.Row="1">
                        <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"
                                                MinWidth="0"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <Border Name="SidebarBorder"
                                        Grid.Column="0"
                                        Width="250"
                                        BorderBrush="Gray"
                                        BorderThickness="0,0,1,0"
                                        Background="#F5F5F5"
                                        Visibility="Collapsed">
                                <Grid>
                                        <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="*"/>
                                        </Grid.RowDefinitions>

                                        <DockPanel Grid.Row="0"
                                                        Margin="5">
                                                <TextBlock Text="🔖 책갈피"
                                                                FontWeight="Bold"
                                                                VerticalAlignment="Center"
                                                                DockPanel.Dock="Left"/>
                                                <Button Content="✖"
                                                                Width="20"
                                                                Height="20"
                                                                HorizontalAlignment="Right"
                                                                Background="Transparent"
                                                                BorderThickness="0"
                                                                Click="BtnToggleSidebar_Click"/>
                                        </DockPanel>

                                        <ToolBarTray Grid.Row="1"
                                                        Background="Transparent">
                                                <ToolBar Background="Transparent"
                                                                OverflowMode="Never">
                                                        <Button Content="➕"
                                                                        ToolTip="현재 페이지 추가"
                                                                        Click="BtnAddBookmark_Click"/>
                                                        <Button Content="➖"
                                                                        ToolTip="삭제"
                                                                        Click="BtnDeleteBookmark_Click"/>
                                                        <Separator/>
                                                        <Button Content="▲"
                                                                        ToolTip="위로"
                                                                        Click="BtnMoveBookmarkUp_Click"/>
                                                        <Button Content="▼"
                                                                        ToolTip="아래로"
                                                                        Click="BtnMoveBookmarkDown_Click"/>
                                                </ToolBar>
                                        </ToolBarTray>

                                        <TreeView Grid.Row="2"
                                                        Name="BookmarkTree"
                                                        ItemsSource="{Binding SelectedDocument.Bookmarks}"
                                                        BorderThickness="0"
                                                        Background="Transparent"
                                                        AllowDrop="True"
                                                        PreviewMouseLeftButtonDown="BookmarkTree_PreviewMouseLeftButtonDown"
                                                        PreviewMouseMove="BookmarkTree_PreviewMouseMove"
                                                        Drop="BookmarkTree_Drop"
                                                        DragOver="BookmarkTree_DragOver"
                                                        SelectedItemChanged="BookmarkTree_SelectedItemChanged"
                                                        KeyDown="BookmarkTree_KeyDown">
                                                <TreeView.ItemTemplate>
                                                        <HierarchicalDataTemplate ItemsSource="{Binding Children}">
                                                                <StackPanel Orientation="Horizontal"
                                                                                Background="Transparent">
                                                                        <Grid Margin="0,0,5,0">
                                                                                <TextBlock Text="{Binding Title}"
                                                                                                VerticalAlignment="Center">
                                                                                        <TextBlock.Style>
                                                                                                <Style TargetType="TextBlock">
                                                                                                        <Setter Property="Visibility"
                                                                                                                        Value="Visible"/>
                                                                                                        <Style.Triggers>
                                                                                                                <DataTrigger Binding="{Binding IsEditing}"
                                                                                                                                Value="True">
                                                                                                                        <Setter Property="Visibility"
                                                                                                                                        Value="Collapsed"/>
                                                                                                                </DataTrigger>
                                                                                                        </Style.Triggers>
                                                                                                </Style>
                                                                                        </TextBlock.Style>
                                                                                </TextBlock>
                                                                                <TextBox Text="{Binding Title, UpdateSourceTrigger=PropertyChanged}"
                                                                                                VerticalAlignment="Center"
                                                                                                KeyDown="BookmarkRename_KeyDown"
                                                                                                LostFocus="BookmarkRename_LostFocus">
                                                                                        <TextBox.Style>
                                                                                                <Style TargetType="TextBox">
                                                                                                        <Setter Property="Visibility"
                                                                                                                        Value="Collapsed"/>
                                                                                                        <Style.Triggers>
                                                                                                                <DataTrigger Binding="{Binding IsEditing}"
                                                                                                                                Value="True">
                                                                                                                        <Setter Property="Visibility"
                                                                                                                                        Value="Visible"/>
                                                                                                                </DataTrigger>
                                                                                                        </Style.Triggers>
                                                                                                </Style>
                                                                                        </TextBox.Style>
                                                                                </TextBox>
                                                                        </Grid>
                                                                        <TextBlock Text="{Binding PageNumber, StringFormat=' (p.{0})'}"
                                                                                        Foreground="Gray"
                                                                                        FontSize="10"
                                                                                        VerticalAlignment="Center"
                                                                                        IsHitTestVisible="False"/>
                                                                        <StackPanel.ContextMenu>
                                                                                <ContextMenu>
                                                                                        <MenuItem Header="이름 변경 (F2)"
                                                                                                        Click="BtnRenameBookmark_Click"/>
                                                                                        <MenuItem Header="현재 페이지로 위치 갱신"
                                                                                                        Click="BtnUpdateBookmarkPage_Click"/>
                                                                                        <Separator/>
                                                                                        <MenuItem Header="삭제"
                                                                                                        Click="BtnDeleteBookmark_Click"/>
                                                                                </ContextMenu>
                                                                        </StackPanel.ContextMenu>
                                                                </StackPanel>
                                                        </HierarchicalDataTemplate>
                                                </TreeView.ItemTemplate>
                                                <TreeView.ItemContainerStyle>
                                                        <Style TargetType="TreeViewItem">
                                                                <Setter Property="IsExpanded"
                                                                                Value="{Binding IsExpanded, Mode=TwoWay}"/>
                                                                <Setter Property="IsSelected"
                                                                                Value="{Binding IsSelected, Mode=TwoWay}"/>
                                                        </Style>
                                                </TreeView.ItemContainerStyle>
                                        </TreeView>
                                </Grid>
                        </Border>

                        <GridSplitter Grid.Column="1"
                                        Width="5"
                                        HorizontalAlignment="Center"
                                        Background="LightGray"
                                        ResizeBehavior="PreviousAndNext"/>

                        <TabControl Name="MainTabControl"
                                        Grid.Column="2"
                                        ItemsSource="{Binding Documents}"
                                        SelectedItem="{Binding SelectedDocument}"
                                        SelectionChanged="MainTabControl_SelectionChanged">
                                <TabControl.ItemTemplate>
                                        <DataTemplate>
                                                <StackPanel Orientation="Horizontal">
                                                        <TextBlock Text="{Binding FileName}"
                                                                        Margin="0,0,5,0"/>
                                                        <Button Content="❌"
                                                                        Width="15"
                                                                        Height="15"
                                                                        FontSize="8"
                                                                        Tag="{Binding}"
                                                                        Click="BtnCloseTab_Click"
                                                                        Background="Transparent"
                                                                        BorderThickness="0"/>
                                                </StackPanel>
                                        </DataTemplate>
                                </TabControl.ItemTemplate>

                                <TabControl.ContentTemplate>
                                        <DataTemplate>
                                                <ListView ItemsSource="{Binding Pages}"
                                                                ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                                                ScrollViewer.VerticalScrollBarVisibility="Auto"
                                                                ScrollViewer.CanContentScroll="True"
                                                                ScrollViewer.ScrollChanged="PdfListView_ScrollChanged"
                                                                VirtualizingPanel.ScrollUnit="Pixel"
                                                                VirtualizingPanel.VirtualizationMode="Recycling"
                                                                Loaded="PdfListView_Loaded"
                                                                Unloaded="PdfListView_Unloaded"
                                                                Background="LightGray"
                                                                BorderThickness="0"
                                                                PreviewMouseDown="ListView_PreviewMouseDown">
                                                                                <ListView.ItemContainerStyle>
                                                                                        <Style TargetType="ListViewItem">
                                                                                                <Setter Property="Margin"
                                                                                                                Value="10"/>
                                                                                                <Setter Property="HorizontalContentAlignment"
                                                                                                                Value="Center"/>
                                                                                                <Setter Property="Focusable"
                                                                                                                Value="False"/>
                                                                                        </Style>
                                                                                </ListView.ItemContainerStyle>
                                                        <ListView.ItemTemplate>
                                                                <DataTemplate>
                                                                        <Border BorderBrush="Black"
                                                                                        BorderThickness="1"
                                                                                        Background="White">
                                                                                <Border.Effect>
                                                                                        <DropShadowEffect BlurRadius="10"
                                                                                                        ShadowDepth="5"
                                                                                                        Opacity="0.5"/>
                                                                                </Border.Effect>

                                                                                <Grid Width="{Binding Width}"
                                                                                                Height="{Binding Height}"
                                                                                                Tag="{Binding PageIndex}"
                                                                                                Loaded="PageGrid_Loaded"
                                                                                                Unloaded="PageGrid_Unloaded"
                                                                                                PreviewMouseDown="Page_MouseDown"
                                                                                                PreviewMouseMove="Page_MouseMove"
                                                                                                PreviewMouseUp="Page_MouseUp"
                                                                                                Background="Transparent">
                                                                                        <Image Source="{Binding ImageSource}"
                                                                                                        Stretch="Uniform"
                                                                                                        HorizontalAlignment="Left"
                                                                                                        VerticalAlignment="Top"
                                                                                                        IsHitTestVisible="False">
                                                                                                <Image.LayoutTransform>
                                                                                                        <RotateTransform Angle="{Binding Rotation}"/>
                                                                                                </Image.LayoutTransform>
                                                                                        </Image>

                                                                                        <Canvas Background="Transparent"
                                                                                                        IsHitTestVisible="False">
                                                                                                <Border Canvas.Left="{Binding SelectionX}"
                                                                                                                Canvas.Top="{Binding SelectionY}"
                                                                                                                Width="{Binding SelectionWidth}"
                                                                                                                Height="{Binding SelectionHeight}"
                                                                                                                Visibility="{Binding IsSelecting, Converter={StaticResource BooleanToVisibilityConverter}}">
                                                                                                        <Border.Style>
                                                                                                                <Style TargetType="Border">
                                                                                                                        <Setter Property="BorderBrush" Value="Blue"/>
                                                                                                                        <Setter Property="BorderThickness" Value="1"/>
                                                                                                                        <Setter Property="Background" Value="#300000FF"/>
                                                                                                                        <Style.Triggers>
                                                                                                                                <DataTrigger Binding="{Binding IsHighlighting}" Value="True">
                                                                                                                                        <Setter Property="BorderBrush" Value="Transparent"/>
                                                                                                                                        <Setter Property="BorderThickness" Value="0"/>
                                                                                                                                        <Setter Property="Background" Value="#50FFFF00"/>
                                                                                                                                </DataTrigger>
                                                                                                                        </Style.Triggers>
                                                                                                                </Style>
                                                                                                        </Border.Style>
                                                                                                </Border>
                                                                                        </Canvas>

                                                                                        <Canvas x:Name="AnnotationCanvas"
                                                                                                        HorizontalAlignment="Stretch"
                                                                                                        VerticalAlignment="Stretch"
                                                                                                        Loaded="AnnotationCanvas_Loaded"/>
                                                                                </Grid>
                                                                        </Border>
                                                                </DataTemplate>
                                                        </ListView.ItemTemplate>
                                                </ListView>
                                        </DataTemplate>
                                </TabControl.ContentTemplate>
                        </TabControl>
                </Grid>

                <StatusBar Grid.Row="2">
                        <StatusBarItem>
                                <TextBlock x:Name="TxtStatus"
                                                Text="준비"/>
                        </StatusBarItem>
                        <StatusBarItem>
                                <ProgressBar x:Name="PbStatus"
                                                Width="100"
                                                Height="15"
                                                Visibility="Collapsed"/>
                        </StatusBarItem>
                        <StatusBarItem HorizontalAlignment="Right">
                                <TextBlock x:Name="TxtPageInfo"
                                                Text="0 / 0"
                                                FontWeight="Bold"
                                                Margin="0,0,20,0"/>
                        </StatusBarItem>
                        <StatusBarItem HorizontalAlignment="Right">
                                <StackPanel Orientation="Horizontal">
                                        <Button Content="-"
                                                        Click="BtnZoomOut_Click"
                                                        Width="20"/>
                                        <Slider Minimum="0.1"
                                                        Maximum="5.0"
                                                        Value="{Binding SelectedDocument.Zoom}"
                                                        Width="100"/>
                                        <Button Content="+"
                                                        Click="BtnZoomIn_Click"
                                                        Width="20"/>
                                </StackPanel>
                        </StatusBarItem>
                </StatusBar>

                <Popup Name="SelectionPopup"
                                StaysOpen="False"
                                Placement="Bottom">
                        <Border Background="White"
                                        BorderBrush="Gray"
                                        BorderThickness="1"
                                        Padding="5">
                                <StackPanel Orientation="Horizontal">
                                        <Button Content="복사"
                                                        Click="BtnPopupCopy_Click"
                                                        Margin="2"/>
                                        <Button Content="이미지 복사"
                                                        Click="BtnPopupCopyImage_Click"
                                                        Margin="2"/>
                                        <Button Content="형광펜(초록)"
                                                        Click="BtnPopupHighlightGreen_Click"
                                                        Background="LightGreen"
                                                        Margin="2"/>
                                        <Button Content="형광펜(주황)"
                                                        Click="BtnPopupHighlightOrange_Click"
                                                        Background="Orange"
                                                        Margin="2"/>
                                        <Button Content="밑줄"
                                                        Click="BtnPopupUnderline_Click"
                                                        Margin="2"/>
                                </StackPanel>
                        </Border>
                </Popup>
        </Grid>
</Window>